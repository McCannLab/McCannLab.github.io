<!doctype html><html lang=en-us>
<head>
<head>
<br><br>
<title>Releasing the research compendium for our 'Labmnivory' paper</title>
<style>html body{font-family:,sans-serif;background-color:#fff}:root{--accent:#2196F3;--border-width:0}</style>
<link rel=stylesheet href=/css/main.css>
<link rel=stylesheet href=/css/custom.css>
<link href=https://unpkg.com/ionicons@4.2.2/dist/css/ionicons.min.css rel=stylesheet>
<link rel=stylesheet href=/css/font-awesome.min.css>
<link rel=stylesheet href=/css/academicons.min.css>
<script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script>
<script src=/js/jquery-ui-1.9.1.custom.min.js></script>
<script src=/js/jquery.tocify.min.js></script>
<script src=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js integrity=sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa crossorigin=anonymous></script>
<link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css integrity=sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u crossorigin=anonymous>
<link rel=stylesheet href=https://unpkg.com/leaflet@1.5.1/dist/leaflet.css integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ==" crossorigin>
<script src=https://unpkg.com/leaflet@1.5.1/dist/leaflet.js integrity="sha512-GffPMF3RvMeYyc1LWMHtK8EbPv0iNZ8/oTtHPx9/cc2ILxQ+u905qIwdpULaqDkyBKgOaB57QTMg7ztg8Jm2Og==" crossorigin></script>
<meta name=generator content="Hugo 0.89.4">
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
</head>
</head>
<body>
<nav class="navbar navbar-default navbar-fixed-top">
<div class=container>
<div class=navbar-header>
<button type=button class=navbar-toggle data-toggle=collapse data-target=#bs-example-navbar-collapse-1>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
</div>
<div class="collapse navbar-collapse" id=bs-example-navbar-collapse-1>
<ul class="nav navbar-nav mr-auto">
<li><a href=/>Home</a></li>
<li><a href=/contact/>Contact</a></li>
<li class=dropdown>
<a href=# class=dropdown-toggle data-toggle=dropdown role=button aria-haspopup=true aria-expanded=true> <span class=nav-label>Members</span> <span class=caret></span></a>
<ul class=dropdown-menu>
<li><a href=/members/>Current</a></li>
<li><a href=/members/#alumni>Alumni</a></li>
</ul>
</li>
<li><a href=/research/>Research</a></li>
<li><a href=/publications/>Publications</a></li>
<li><a href=/post/>Blog</a></li>
<li><a href=http://www.biodiversityresilience.com/>BiRN</a></li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li class=navbar-icon> <a href=https://github.com/McCannLab><i class="fa fa-github fa-2x"></i></a></li>
<li class=navbar-icon> <a href=https://twitter.com/mccannlab><i class="fa fa-twitter fa-2x"></i></a></li>
</ul>
</ul>
</div>
</div>
</nav>
<br>
<div class=container>
<div class=row>
<div class="col-sm-1 hidden-sm hidden-xs">
</div>
<div class=col-sm-9>
<div class=article-meta>
<h1><span class=title>Releasing the research compendium for our 'Labmnivory' paper</span></h1>
<p style=font-size:1.5em;margin-top:20px> <i class="fa fa-pencil" aria-hidden=true></i>
<a href=/members/>Kevin Cazelles</a> &nbsp;
<a href=/members/>Marie Gutgesell</a> &nbsp;
<a href=#></a></p>
<h3 class=date style=font-size:1.25em>December 13, 2021</h2>
<p class=tags>
<i class="fa fa-tags" aria-hidden=true></i> &nbsp;
<a href=/tags/reproducibility> <kbd class=item-tag>reproducibility</kbd></a>
<a href=/tags/research-compendium> <kbd class=item-tag>research compendium</kbd></a>
<a href=/tags/zenodo> <kbd class=item-tag>Zenodo</kbd></a>
<a href=/tags/github> <kbd class=item-tag>GitHub</kbd></a>
</p>
<p> <a href=https://twitter.com/share class=twitter-share-button data-show-count=true data-text="Releasing the research compendium for our 'Labmnivory' paper">Tweet</a>
<script async src=//platform.twitter.com/widgets.js></script>
</p>
</div>
<p>Good news everyone! This week, our &ldquo;Labmnivory&rdquo; paper led by <a href=https://www.researchgate.net/profile/Marie-Gutgesell>Marie Gutgesell</a> has been accepted in <a href=https://academic.oup.com/bioscience>Bioscience</a>. Therefore, the time has come to release the code we promised explicitly in the manuscript.</p>
<blockquote>
<p>Code for theoretical investigations will be made available on GitHub and archive on Zenodo upon manuscript acceptance.</p>
</blockquote>
<p>For <a href=https://www.ncbi.nlm.nih.gov/books/NBK547546/>reproducibility</a>&rsquo;s sake, we&rsquo;ve structured our <a href=https://julialang.org/>Julia</a>&rsquo;s scripts as a <a href=https://research-compendium.science/>research compendium</a> which so far has been <a href=https://github.com/McCannLab/Labmnivory/>hosted on GitHub</a>, in a private repository. The goal of this post is to go over the different steps to have our research compendium archived on <a href=https://zenodo.org/>Zenodo</a>. Having the full set of scripts used to obtain the results of a given study archived publicly somewhere doesn&rsquo;t hurt! If you skip this step, you may end up in a situation where someone is trying to reproduce your results and is failing at it&mldr; In such case, it is most likely you will feel very bad not being able to find the original code!</p>
<h3 id=1-make-the-repository-public>1. Make the repository public</h3>
<p>As mentioned above, for our theoretical investigations, we worked on a private GitHub repository. Working on a private repository isn&rsquo;t really necessary &ndash; I don&rsquo;t think it would have changed anything if we had been working on a public one for this study &ndash; but it is sort of a convenient way to distinguish projects: the ones that are under active development remain private and the ones that are either ready to be published, accepted or already published are public.</p>
<p>The important point here is that archiving the content of a GitHub repository on Zenodo is super easy, but to do so, the repository <em>must</em> be public. Assuming there isn&rsquo;t any problem with this, the way to proceed is straightforward and well-documented on <a href=https://docs.github.com/en/repositories/managing-your-repositorys-settings-and-features/managing-repository-settings/setting-repository-visibility>GitHub documentation</a>. By the way, turning the repository into a public one makes one Octocat very happy (on Slack) ⬇️.</p>
<p><img src=img/happy_octocat.png alt="Screenshot on Slack App"></p>
<h3 id=2-cleaning-up-the-repository>2. Cleaning up the repository</h3>
<p>In the best-case scenario, our code has been clean day one and has remained so until the day of manuscript acceptance. We are rarely working under this scenario, therefore cleaning up your repository before publishing is an important step.</p>
<p>Sharing our code is good for <a href=https://towardsdatascience.com/how-and-why-to-share-scientific-code-64fbd385a67>several reasons</a>, but if it means sharing a bunch of scripts more or less structured, poorly documented and bundled together with chunks of old/legacy/unused code&mldr; all the efforts become futile. We may still be able to use your code the day you release but it is likely that nobody else could (at least, not within a reasonable amount of time), and &ldquo;nobody&rdquo; actually includes future us&mldr;</p>
<p>Even though it is an important step, I don&rsquo;t think it is worth spending days on this. Note that with <a href=https://www.hongkiat.com/blog/developer-habits/>good habits</a>, the time spent on this task is much reduced. Note that although we aren&rsquo;t professional programmers, various programming principles are simple enough to be adopted, e.g</p>
<ul>
<li><a href=https://en.wikipedia.org/wiki/Edsger_W._Dijkstra>&ldquo;two or more use a for&rdquo;</a>,</li>
<li><a href=https://en.wikipedia.org/wiki/Don%27t_repeat_yourself>DRY</a> (Don&rsquo;t repeat yourself).</li>
</ul>
<p>But even without such habits, one can simply go over a simple check list. I think the one below gives an idea of the sort of things to be considered.</p>
<ol>
<li>Use a logical file structure for the repository. Our <a href=https://github.com/McCannLab/Labmnivory/>repository</a> has a simple structure that suits our needs: <code>src/</code> for the code (as for a <a href=https://pkgdocs.julialang.org/v1/creating-packages/>Julia&rsquo;s package</a>), <code>fig</code> for the figures.</li>
<li>Add some guidelines pertaining to the usage of your code, with a GitHub repository, a natural file to do so is the README (see commit <a href=https://github.com/McCannLab/Labmnivory/commit/19e08bb6c6795accfb268d96d217d8a3d93d11cd>19e08bb</a>).</li>
<li>Remove all unused code (see commit <a href=https://github.com/McCannLab/Labmnivory/commit/74dd1f048f5242fd8147045b2abe90519aeabf57>74dd1f0</a> for an example). Note that if parts of the old code might be useful at some point for another project, copy-paste them and/or make sure it is included in a previous version of your code that will remain available;</li>
<li>Comment all numerical tricks. It is important to <em>not</em> being overconfident as it is hard to remember everything we did accurately.</li>
</ol>
<p>Again, the goal is to do as much as possible within a reasonable amount of time. I don&rsquo;t think it&rsquo;s worth spending days on choosing variable names or on the number of folders required&mldr; Plus, I seriously doubt there is a single best solution whereas I am very confident that there is a plethora of OK solutions. ⚠️ In case this was not clear, cleaning up the repository is not the time to modify the analysis, we are merely making cosmetic changes to the code to make it clearer.</p>
<h3 id=3-making-sure-we-are-able-to-reproduce-the-analysis>3. Making sure we are able to reproduce the analysis</h3>
<p>What we are trying to achieve here is to publish the code that was used to obtain the results we are publishing in a scientific article. The cleaning up shouldn&rsquo;t affect the analysis but it is possible that some of the minor changes we&rsquo;ve made introduced an errors, e.g. a variable name has been changed and we forgot to replace the old name in a few places. So before releasing the code, it is important to double check that we are still obtaining the same results.</p>
<p>Before manuscript submission, we ensured that the analysis runs seamlessly on more than one computer. On GitHub, <a href=https://docs.github.com/en/actions>GitHub Actions</a> allows us to do so, but only on public repository (the time on GitHub&rsquo;s servers is limited for private repositories for free plans). The easy solution is to use another machine and check that the analysis runs correctly. But once we&rsquo;ve made the repository public, the time limit is released and thus we can use GitHub Actions. For this study, the analysis was checked on <a href=https://docs.github.com/en/actions/using-github-hosted-runners/about-github-hosted-runners>three of the currently available runners</a> macOS Catalina, Ubuntu 20.04 and Windows Server 2019.</p>
<p><a href=https://github.com/McCannLab/Labmnivory/actions><img src=img/actions.png alt></a></p>
<p>The way this was set up is pretty simple, all the simulations have been gathered in one file, <a href=https://github.com/McCannLab/Labmnivory/blob/master/src/pipeline.jl><code>scr/pipeline.jl</code></a>, and we are running the one command line on GitHub&rsquo;s servers (see <a href=https://github.com/McCannLab/Labmnivory/blob/b2581021f421cd62f433aac8310fc9610353c658/.github/workflows/reproduce.yaml#L29><code>reproduce.yaml</code></a>.</p>
<p>Note that simulations for two of the supplementary figures were skipped because I don&rsquo;t think it is worth re-running them. Mainly because those are time/energy consuming as the analysis for each of the figures takes approximately 2 hours to run (and I did not see the point of optimizing the code for this), so it means 12 hours on the servers (not even sure we are allowed to do that). Furthermore, the main piece of code use for these simulations is also used for the other figures, so running the code that produces the other figures is a partial evidence that these simulations would work. Even though these simulations are skipped they are ready to be run (see <a href=https://github.com/McCannLab/Labmnivory/blob/60117e3868e7e90580e3fef3f344466e92c4d4b3/src/pipeline.jl#L44-L50><code>pipeline.jl</code></a>).</p>
<h3 id=4-create-a-release-with-zenodo>4. Create a release with Zenodo</h3>
<p>As explained on <a href=https://en.wikipedia.org/wiki/Zenodo>Wikipedia</a></p>
<blockquote>
<p>Zenodo [&mldr;] allows researchers to deposit research papers, data sets, research software, reports, and any other research related digital artefacts. For each submission, a persistent digital object identifier (DOI) is minted, which makes the stored items easily citeable.</p>
</blockquote>
<p>There are various tutorials online that explain how to do upload your archive (e.g. this one on <a href=https://instruct-eric.eu/help/other/zenodo-upload-guidelines>instruct-eric.eu</a>), but if you are using GitHub it&rsquo;s even simpler. Zenodo is indeed capable of archiving a GitHub&rsquo;s release and it uses all information on your GitHub repository to fill out the description fields. So once you have <a href=https://docs.github.com/en/repositories/archiving-a-github-repository/referencing-and-citing-content>linked your GitHub account to Zenodo</a>, it literally takes 2 minutes to obtain a DOI for your archive. There are several tutorials that explain how to use Zenodo with GitHub, see for instance the video below.</p>
<div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden>
<iframe src=https://www.youtube.com/embed/Atp-GmhS7gY style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe>
</div>
<p>That&rsquo;s basically what we&rsquo;ve done and we obtained the following <a href=https://zenodo.org/badge/latestdoi/263917634><img src=https://zenodo.org/badge/263917634.svg alt=DOI></a>.
Below is the Zenodo page of our archive.</p>
<p><a href=https://zenodo.org/record/5776233><img src=img/archive.png alt></a></p>
<p>We&rsquo;ve added the badge on the README of the repository and once we get the DOI for the paper, we will simply add it too so people that stumble into our repository can easily find the actual paper.</p>
<h3 id=5-add-the-new-text-in-the-manuscript>5. Add the new text in the manuscript</h3>
<p>In the manuscript we added the following sentence</p>
<blockquote>
<p>Code for theoretical investigations will be made available on GitHub and archive on Zenodo upon manuscript acceptance.</p>
</blockquote>
<p>Now we&rsquo;ve done our work, we have not only have a GitHub repository to share but also a DOI associated with a Zenodo archive of our code and we need to let readers know about these two (or only the Zenodo DOI).</p>
<blockquote>
<p>The code to reproduce this study is available as an archived
compendium (<a href=https://doi.org/10.5281/zenodo.5776233>https://doi.org/10.5281/zenodo.5776233</a>) and the
corresponding development repository is available at the fol-
lowing URL <a href=https://github.com/McCannLab/Labmnivory>https://github.com/McCannLab/Labmnivory</a>.</p>
</blockquote>
<p>We&rsquo;re done! One more reproducible study!</p>
<h3 id=last-remark>Last remark</h3>
<p>It takes some time to tidy up the repository, ensure that the analysis is reproducible, but it is 💯% worth it.</p>
</div>
</div>
<div class="col-sm-1 hidden-sm hidden-xs">
</div>
</div>
<br><br>
<footer>
<div class=row>
<div class=col-sm-1>
<div class="hidden-sm hidden-xs">
</div>
</div>
<div class=col-sm-9>
<div class=container>
<hr>
<div class=row>
<div class=col-sm-6>
<br>
© McCannLab 2018-2021
</div>
<div class=col-sm-3>
<br>
<a href=https://www.foodfromthought.ca/><strong>Food From Thought</strong></a>
<br>
This research was undertaken thanks in part to funding from the Canada First Research Excellence Fund.
</div>
<div class=col-sm-3>
<img src=/img/CFREF_Logo_EN.png alt>
<br>
</div>
</div>
</div>
</div>
<br>
</footer>
</body>
</html>